# ----------------------------------------------------------------------
# ~/.config/zsh/zshrc (SHARED - Zinit, Plugins, Portable Paths)
# ----------------------------------------------------------------------

# 1. Zinit æ’ä»¶ç®¡ç†å™¨ (è‡ªåŠ¨å®‰è£…ä¸åŠ è½½)
ZINIT_HOME="${XDG_DATA_HOME:-${HOME}/.local/share}/zinit/zinit.git"
if [[ ! -d $ZINIT_HOME ]]; then
    print -P "%F{red}--- Zinit not found. Installing... ---%f"
    mkdir -p "$(dirname $ZINIT_HOME)"
    git clone https://github.com/zdharma-continuum/zinit.git "$ZINIT_HOME"
fi
source "${ZINIT_HOME}/zinit.zsh"

# 2. Zinit æ’ä»¶é…ç½® (æ‰€æœ‰æ’ä»¶)
zinit light zdharma-continuum/fast-syntax-highlighting
zinit light zsh-users/zsh-autosuggestions
zinit light zsh-users/zsh-completions
# zinit light autojump/autojump
zinit light wting/autojump               
zinit light zsh-users/zsh-history-substring-search
zinit light sindresorhus/pure

# 3. å¿«æ·é”®ç»‘å®š
bindkey '^ ' autosuggest-accept
bindkey 'â†’' autosuggest-accept
bindkey '^E' autosuggest-accept
bindkey '^J' autosuggest-execute

# 4. é€šç”¨å·¥å…·åˆå§‹åŒ– (åŸºäº $HOME çš„è·¯å¾„)
export SDKMAN_DIR="$HOME/.sdkman"
[[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]] && source "$HOME/.sdkman/bin/sdkman-init.sh"

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && \. "$NVM_DIR/nvm.sh"
[ -s "$NVM_DIR/bash_completion" ] && \. "$NVM_DIR/bash_completion"

export PATH="$HOME/fvm/default/bin:$PATH"
export PATH="$HOME/.pyenv/bin:$PATH"
eval "$(pyenv init --path)"
eval "$(pyenv init -)"

export BUN_INSTALL="$HOME/.bun"
export PATH="$BUN_INSTALL/bin:$PATH"
[ -s "$BUN_INSTALL/bin/_bun" ] && source "$BUN_INSTALL/bin/_bun"

export PATH="$HOME/.local/bin:$PATH"
[[ -f "$HOME/.dart-cli-completion/zsh-config.zsh" ]] && . "$HOME/.dart-cli-completion/zsh-config.zsh"
source <(ng completion script)

# 5. ğŸš¨ åŠ¨æ€åŠ è½½ï¼šä¸»æœºåå·®å¼‚é…ç½® & ç§å¯†é…ç½®
# --- åŠ è½½ä¸»æœºç‰¹å®šé…ç½® (Stow é“¾æ¥çš„ç›®æ ‡) ---
HOST_LOCAL_FILE="$HOME/.config/zsh/$(hostname).local.zsh"
if [ -f "$HOST_LOCAL_FILE" ]; then
    source "$HOST_LOCAL_FILE"
fi

# --- åŠ è½½ç§å¯†æ–‡ä»¶ (æ‰‹åŠ¨åˆ›å»ºï¼Œä¸åœ¨ Git ä¸­) ---
SECRETS_FILE="$HOME/.config/zsh/secrets.sh"
if [ -f "$SECRETS_FILE" ]; then
    source "$SECRETS_FILE"
fi
